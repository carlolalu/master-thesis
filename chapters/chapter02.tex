The first part of this chapter will define a toy model of reality.
A key difference will be that the amoeba will release a single cAMP with no initial velocity for each spawning moment.
The second important difference is that the release of cAMP will be regulated by a Poisson process, thus ignoring the fact that in reality the amoebas should respond to each trace of cAMP with the release of a chemical cry of more chemotaxin.
The second part of the chapter is concerned with the definition of an alternative version of this first design, which can be handy for certain mathematical operations.
Recall that the space is throughout the whole master thesis $\R^d$ with $d\in\{2,3\}$, thus not the phase space.

\section{Deterministic parenting toy model}

In words we can describe this design in this way:
\begin{enumerate}
\item There is a fixed number $N$ of amoebas, each subjected to its own Brownian motion with constant diffusion coeffiecient $\sigma^\amba$
\item Each amoeba $\amba^p$ attracted to the cAMP molecules with a potential $\potential$ which has properties [[PROPERTIES MODELLED ON THE GAUSSIAN]]
\item Each amoeba $\amba^p$ spawns cAMP molecules $\camp^{p,g}$ (p=parent, g=generation) with a Poisson process $\hmactive^p$ of parameter $\lambda$ indipendent of $p$
\item Each cAMP molecule is born at the position of its parent and is subjected from that time on to its own Brownian motion with constant diffusion coefficient $\sigma^\camp$
\item All the Brownian motions for each particle are indipendent from each others
\end{enumerate}

Let us work more precisely.

Let $N\in\N$ be the number of amoebas, and fix $N$ indipendent Poisson processes $(\hmactive^p)_{i=1}^N$ of parameter $\lambda$.
Define for each parent $p \in \{1,\ldots,N\}$ and each generation $g \in \N$, the stopping time

\begin{equation}
\btime^{p,g} := \inf \{ t : \hmactive^p_t \geq g \} \sim \Gma(g, \lambda)
\end{equation}

\ie the \emph{spawning} or \emph{birth time} of the $\camp^{p,g}$ cAMP molecule.

[[HERE ILLUSTRATION OF WHAT IS HAPPENING TIMEWISE]]

Consider a countable collection of indipendent Brownian motions 

\begin{equation}
\{B^{A,p}, B^{C,p,g}\}_{1\leq p\leq N,g\in\N} =:\{B^p, B^{p,g}\}_{p,g}
\end{equation}

\ie $N$ of them for the amoebas and a countable amount for the cAMP molecules.
Now we need an important passage to accurately define the Brownian movement of the cAMP particles.
In fact each of these moves only after spawning, and thus such movement must be calibrated for starting after this moment, and not before.
For each $1\leq p \leq N,g \in \N$ consider the process

\begin{equation}
B_t^{p,g,(\btime^{p,g})} := B_{\btime^{p,g}+t}^{p,g} - B_{\btime^{p,g}}^{p,g}
\end{equation}

Such process is a Brownian motion because of the strong Markov property (\citep[Theorem 2.20]{le-gall}), but this is shifted of a time $T^{p,g}$.
Wat we need is a "quasi-Brownian motion", which is $0$ till the time $T^{p,g}$ and afterward starts without shifts forward, thus this object:

\begin{figure}[h]
\begin{tikzpicture}
\end{tikzpicture}
\caption{[[ Add HERE TIKZ PICTURE SHOWING IN DIFFERENT COLORS THE VARIOUS PROCESSES INVOLVED]]}
\end{figure}

\begin{equation}\label{ch2:quasi-bm-camp}
\quasibm_t^{p,g} := "B_{t-\btime^{p,g}}^{p,g,(\btime^{p,g})}\1_{t-\btime^{p,g}\geq 0}"
\left\{
\begin{aligned}
& 0 
& t<T^{p,g}
\\
& B_{t-\btime^{p,g}}^{p,g,(\btime^{p,g})} = B_{t}^{p,g} - B_{\btime^{p,g}}^{p,g}
& t \geq \btime^{p,g}
\end{aligned}
\right.
\end{equation}

With these indipendent processes we can now finally write down the model as a set of stochastic differential equations:

\begin{equation}
\left\{
\begin{aligned}
\amba_t^p 
&= \amba_0^p 
+ \int_0^t \frac{1}{N} \sum _{p = 1}^{N} \sum_{g = 1}^{\hmactive_s^p} \drift(\amba_s^p - \camp_s^{p,g}) d s
+ 
\overbrace{\sigma^A B_t^p}^{\int_0^t \sigma_A d B_s^p}
&
\\
\camp_t^{p,g} 
&\qquad\text{does not exist} 
&if \quad t < \btime^{p,g}
\\
\camp_t^{p,g}
&= \amba_{\btime^{p,g}}^p + \underbrace{\sigma_C \quasibm_t^{p,g}}_{\int_0^t \sigma_C Q_s^{p,g}} 
&if \quad t \geq \btime^{p,g}
\end{aligned}
\right.
\end{equation}\label{ch2:model:deterministic-parenting}

\subsection{Observations}

One can immediately notice that not even the dimension of the system \ref{ch2:model:deterministic-parenting} is deterministic: the particles $\camp_t^{p,g}$ are spawning at the stochastic time $\btime^{p,g}$, increasing at each of these instants the number of particles involved (the system is piecewise defined in time).
This, together with the fact that the Poisson processes $\hmactive^p$ cannot be represented with a SDE and that the $Q_t^{p,g}$ are not proper Brownian motions, makes this system formally not a system of SDEs, even though the equations involved are indeed differential and stochastic.

\paragraph{Pitfall definitions}\label{ch2:pitfall} One could argue that a possible solution to render at least the dimension not stochastic could be done like this: let all the particles exist since the instant $0$, and simply consider a subset of them, the "active" ones, for the attraction of the amoebas.
This is indeed a good method, but, as we will see, would then create great difficulties later. 
In fact at the spawning moment the particle $\camp^{p,g}$ must be at the position $\amba_{\btime^{p,g}}^p$, which means that either it suddenly jumps at such position, making hard to prove the existence and uniqueness of solutions for the system because of the non-easy-to-deal-with kind of discontinuouty in time (see \ref{ch3:avoid-pitfall-of-jumping-particles}) or would have to follow the amoeba till the moment of spawning, rendering hard the proper definition and comparison of the relative the mean-field particles ([[HERE INSERT THE PROPER REFERENCE TO THE CHAPTER OF mean-field particles, THIS HAPPENS WHEN THE PARTICLES FOLLOW THEIR PARENTS TILL THE SPAWNING MOMENTS]]).


\section{Random (casual) parenting toy model}

Here we try to build a mathematically handier version of the previous model. Since the Poisson processes $M^p$s determining the spawning times of particles are independent for each amoeba, we have that

\begin{equation}
\hmactive_t := \sum_{p=1}^N \hmactive_t^p
\end{equation}

is $\Pois(N \lambda)$-distributed. Therefore the correspondent birth times

\begin{equation}
\btime_m := \inf \{ t : \hmactive_t \geq m\}
\end{equation}

are $\Gma(m, N\lambda)$-distributed.
Taking these as spawning times and indicising the cAMP particles consequently, we can imagine that each $\camp^m$ is spawned at its birth time with uniform probability on the position of one of the amoebas.
Mathematically this means considering a "parenting function" $P(m)$ which will represent the spawning amoeba of the $\camp^m$ particle.
Assume that $P(m) \sim \Unf_{\{1,\ldots,N\}}$ and that $\forall m_1 \neq m_2.P(m_1) \indep P(m_2)$.
Then we can redefine the model as:

\begin{equation}
\left\{
\begin{aligned}
\amba_t^p 
&= \amba_0^p 
+ \int_0^t \frac{1}{N} \sum _{m = 1}^{\hmactive_s} \drift(\amba_s^p - \camp_s^m) d s
+ 
\overbrace{\sigma^A B_t^p}^{\int_0^t \sigma_A d B_s^p}
&
\\
\camp_t^m 
&\qquad\text{does not exist} 
&if \quad t < \btime^m
\\
\camp_t^m
&= \amba_{\btime^m}^{P(m)} + \underbrace{\sigma_C \quasibm_t^m}_{\int_0^t \sigma_C Q_s^m}
&if \quad t \geq \btime^m
\end{aligned}
\right.
\end{equation}\label{ch2:model:casual-parenting}

This makes the equations much more simple than before and let us arrange the spawning time chronologically.

\section{Is the casual model just a relabeling?}

Let us explore the answer.
The key is in the definition of the chosen "parenting function" $P$, precisely in the requirement that $\forall m_1 \neq m_2.P(m_1) \indep P(m_2)$.
Let us start from the deterministic parenting model, and let us consider the birth time $\btime_m$.
It is the spawning time of the $m$-th molecule.
Which amoeba is spawning such particle?
Define, for the deterministic parenting model, the function

\begin{equation}
P'(m) := p \quad \text{s.t. }\amba^p \text{ is the parent of } \camp^m
\end{equation}

Let us compare the function $P$ and $P'$.
The first question is if $P'$ is uniformly distributed.

\begin{equation}
\begin{aligned}
\Prb (P'(m) = p) 
&= \Prb (\exists g \in \N. \btime_m = \btime^{p,g} )
\\
&= \sum_{g=1}^{\infty} \Prb (\btime_m = \btime^{p,g})
\end{aligned}
\end{equation}

Let us calculate the distribution of $(\btime_m,\btime^{p,g})$ for generic $m,g,p$.

\begin{equation}
\begin{aligned}
\Prb (\btime_m \leq s,\btime^{p,g} \leq t) 
&= \Prb ( \sum_{k=1}^N \hmactive_s^k \geq m, \hmactive_t^p \geq g)
\\
&= \1_{s\neq t}(\cdots)
+ \1_{s=t}\Prb ( \sqcup_{j=g}^{\infty} (\sum_{k=1}^N \hmactive_s^k \geq m, \hmactive_t^p = j) )
\\
&= \1_{s\neq t}(\cdots)
+ \1_{s=t} \sum_{j=g}^{\infty} \Prb ( (\sum_{k=1}^N \hmactive_s^k - \hmactive_t^p \geq m - j, \hmactive_t^p = j) )
\\
&= \1_{s\neq t}(\cdots)
+ \1_{s=t} \sum_{j=g}^{\infty} \Prb ( \underbrace{(\sum_{k\neq p} \hmactive_s^k \geq m - j, \hmactive_t^p = j)}_{\indep} )
\\
&= \1_{s\neq t}(\cdots)
+ \1_{s=t} \sum_{j=g}^{\infty} \big[ \Prb ( \sum_{k\neq p} \hmactive_s^k \geq m - j) \Prb(\hmactive_t^p = j) \big]
\\
&= \1_{s\neq t}(\cdots)
+ \1_{s=t} \underbrace{\sum_{j=g}^{\infty} \big[ \Pois_{(N-1)s\lambda}([0 \vee (m - j), \infty]) \Pois_{t\lambda}(\{j\})}_{=:\Zhi(m,s,p,g,t)}
\end{aligned}
\end{equation}

Then we notice immediately that $\Zhi$ is independent from $p$, thus also

\begin{equation}
\Prb(\btime_m = dt,\btime^{p,g} = dt) = \partial_t \partial_s \Zhi(m,s,g,t)
\end{equation}

is independent on $p$.
This implies that $\Prb (P'(m) = p) = const(m)$, and thus that $P'(m)$ is uniformly distirbuted, as it is the case for $P(m)$.
This was quite expected, because by reindexing the spawning Poisson processes $\hmactive_t^p$ we should have the same distribution. 

What about the requirement $\forall m_1 \neq m_2.P(m_1) \indep P(m_2)$?
We do expect this to be not the case for the function $P'$: we expect to be more likely that the cAMP molecules are spawned by all amoebas, and not that it is also likely that a process $\hmactive_t^p$ fires many times in a row while the other processes are muted.
If $P'(m)$ would be indipendent from $P'(m+1)$, for two parents $p \neq q$ (we suppose that $N \geq 3$) we should have that:

\begin{equation}
\begin{aligned}
\Prb(P'(m) = p, P'(m+1) = q) 
&= \Prb(P'(m) = p) \Prb(P'(m+1) = q) 
\\
&= \Prb(P'(m) = p) \Prb(P'(m+1) = p) 
\\
&= \Prb(P'(m) = p, P'(m+1) = p)
\end{aligned}
\end{equation}

We found then a possible counterexample:

\begin{equation}
\invquest p\neq q \Longrightarrow \Prb(P'(1) = p, P'(2) = q) = \Prb(P'(1) = p, P'(2) = p) ?
\end{equation}\label{ch2:indep-parenting-function?}

Let us check the LHS of \ref{ch2:indep-parenting-function?}. Assume first that $p\neq q$:

\begin{equation}
\begin{aligned}
\Prb(&P'(1) = p, P'(2) = q) 
= \Prb(\btime_1 = \btime^{p,1}, \btime_2 = \btime^{q,1})
\\
&= \Prb(\hmactive_{\btime_1}^p = 1, \hmactive_{\btime_2}^q = 1)
\\
&= \Prb(\hmactive_{\btime_1}^p = 1, \sum_{k\neq p} \hmactive_{\btime_1}^k = 0, 
	\hmactive_{\btime_2}^q = 1, \hmactive_{\btime_2}^p = 1, \sum_{k\neq p, k \neq q} \hmactive_{\btime_2}^k = 0, )
\\
&= \Prb(\hmactive_{\btime_1}^p = 1, \sum_{k\neq p} \hmactive_{\btime_1}^k = 0,
	\hmactive_{\btime_1,\btime_2}^p = 0, \sum_{k\neq p, k \neq q} \hmactive_{\btime_1,\btime_2}^k = 0,
	\hmactive_{\btime_1,\btime_2}^q = 1)
\\
&= \Prb(\hmactive_{\btime_1}^p = 1, \sum_{k\neq p} \hmactive_{\btime_1}^k = 0,
	\sum_{k \neq q} \hmactive_{\btime_1,\btime_2}^k = 0,
	\hmactive_{\btime_1,\btime_2}^q = 1)
\\
&= \int d\Prb(\btime_1 = s, \btime_2 = t) \underbrace{\Prb(\hmactive_{s}^p = 1, \sum_{k\neq p} 
	\hmactive_{s}^k = 0,\sum_{k \neq q} \hmactive_{s,t}^k = 0,\hmactive_{s,t}^q = 1)}_{=:\Ch_{LHS}}
\end{aligned}
\end{equation}

Thus we have that:

\begin{equation}
\begin{aligned}
\Ch_{LHS}
&= \Prb(\hmactive_{s}^p = 1) \Prb(\sum_{k\neq p} \hmactive_{s}^k = 0) 
	\Prb(\sum_{k \neq q} \hmactive_{s,t}^k = 0)\Prb(\hmactive_{s,t}^q = 1)
\\
&= \Pois_{s\lambda}(\{1\}) \Pois_{(N-1)s\lambda}(\{0\}) \Pois_{(N-1)(t-s)\lambda}(\{0\}) 
	\Pois_{(t-s)\lambda}(\{1\}) 
\end{aligned}
\end{equation}

What about the RHS of \ref{ch2:indep-parenting-function?}?

\begin{equation}
\begin{aligned}
\Prb(&P'(1) = p, P'(2) = p) 
= \Prb(\btime_1 = \btime^{p,1}, \btime_2 = \btime^{p,2})
\\
&= \Prb(\hmactive_{\btime_1}^p = 1, \hmactive_{\btime_2}^p = 2)
\\
&= \Prb(\hmactive_{\btime_1}^p = 1, \sum_{k\neq p} \hmactive_{\btime_1}^k = 0, 
	\hmactive_{\btime_2}^p = 2, \sum_{k\neq p} \hmactive_{\btime_2}^k = 0 )
\\
&= \int d\Prb(\btime_1 = s, \btime_2 = t) \underbrace{\Prb(\hmactive_{s}^p = 1, \sum_{k\neq p} \hmactive_{s}^k = 0,\hmactive_{t}^p = 2, \sum_{k\neq p} \hmactive_{t}^k = 0 )}_{\Ch_{RHS}}
\end{aligned}
\end{equation}

Then

\begin{equation}
\begin{aligned}
\Ch_{LHS}
&= \Prb(\hmactive_{s}^p = 1, \sum_{k\neq p} \hmactive_{s}^k = 0,\hmactive_{s,t}^p = 1,
	\sum_{k\neq p} \hmactive_{s,t}^k = 0 )
\\
&= \Prb(\hmactive_{s}^p = 1)\Prb( \sum_{k\neq p} \hmactive_{s}^k = 0)\Prb(\hmactive_{s,t}^p = 1)
	\Prb(\sum_{k\neq p} \hmactive_{s,t}^k = 0 )
\\
&= \Pois_{s\lambda}(\{1\}) \Pois_{(N-1)s\lambda}(\{0\}) \Pois_{(N-1)(t-s)\lambda}(\{0\}) 
	\Pois_{(t-s)\lambda}(\{1\})
\end{aligned}
\end{equation}









